---
- name: SUBIR CANALES MQ
  hosts: all
  vars:
    ansible_python_interpreter: /QOpenSys/pkgs/bin/python3
    SBSD: QMQM
  collections:
    - ibm.power_ibmi
  connection: ssh
  gather_facts: false
  tasks:

    - name: Validar canal QM1
      ibmi_cl_command:
        cmd: PNGMQMCHL CHLNAME(QM1.TO.QM2) MQMNAME(QM1)
      ignore_errors: true
      register: validate_qm1_chanel

    - name: debug
      debug:
        var: validate_qm1_chanel.job_log | map(attribute='MESSAGE_ID') 

    # - name: debug
    #   debug:
    #     msg: |
    #       "El canal se encuentra arriba"
    #   when: validate_qm1_chanel.job_log | selectattr('MESSAGE_ID', '==', 'AMQ9514') | map(attribute='STATUS') | list

    # - name: INICIAR CANAL QM1.TO.QM2
    #   ibmi_cl_command:
    #     cmd: QMQM/STRMQMCHL CHLNAME(QM1.TO.QM2) MQMNAME(QM1)
    #   ignore_errors: true
    #   register: estado_canal1

    # - name: debug
    #   debug:
    #     var: estado_canal1

    # - name: INICIAR CANAL QM2.TO.QM1
    #   ibmi_cl_command:
    #     cmd: QMQM/STRMQMCHL CHLNAME(QM2.TO.QM1) MQMNAME(QM2)
    #   ignore_errors: true
    #   register: estado_canal2

    # - name: INFORMACIÃ“N ESTADO DEL CANAL
    #   debug:
    #     var: estado_canal2